<template>
  <lightning-layout multiple-rows>
    <lightning-layout-item
      size="12"
      class="slds-var-m-around_large slds-border_top"
    ></lightning-layout-item>
    <lightning-layout-item
      size="12"
      class="slds-var-m-left_xx-large slds-var-p-left_xx-large"
    >
      <p class="slds-text-heading_large">{label.LABEL_Opinions}</p>
    </lightning-layout-item>

    <!-- Reviews section -->
    <lightning-layout-item size="12">
      <lightning-layout multiple-rows class="rev-container">
        <!-- Calculation section -->
        <lightning-layout-item size="12" class="slds-align_absolute-center">
          <lightning-layout>
            <!-- Average stars -->
            <lightning-layout-item size="2" class="slds-align_absolute-center">
              <div>
                <p
                  class="average-number slds-text-align_center slds-var-p-bottom_x-small"
                >
                  {averageRating}
                  <span class="average-total">/{sixSystemStars}</span>
                </p>
                <template for:each={stars} for:item="star">
                  <div key={star.value} class="star">
                    <lightning-icon
                      icon-name="utility:favorite"
                      size="small"
                      class={star.className}
                    ></lightning-icon>
                  </div>
                </template>
                <p
                  class="slds-text-color_weak slds-text-align_center slds-var-p-top_small"
                >
                  ({totalReviews}&nbsp;{label.LABEL_OpinionsLowerCase})
                </p>
              </div>
            </lightning-layout-item>

            <!-- Strips -->
            <lightning-layout-item
              size="4"
              class="slds-var-m-horizontal_medium"
            >
              <template for:each={ratingStrips} for:item="strip">
                <div key={strip.rating} class="strip-container">
                  <div>
                    <lightning-icon
                      icon-name="utility:favorite"
                      size="xx-small"
                      class="slds-var-p-right_xx-small"
                    ></lightning-icon>
                    <span>{strip.rating}</span>
                  </div>
                  <div class="strip slds-var-m-horizontal_small"></div>
                  <div class="opinions">{strip.opinions}</div>
                </div>
              </template>
            </lightning-layout-item>

            <!-- Add review -->
            <lightning-layout-item
              size="4"
              class="slds-box slds-var-m-left_medium"
            >
              <lightning-layout multiple-rows>
                <lightning-layout-item
                  size="12"
                  class="slds-align_absolute-center"
                >
                  <p class="slds-text-heading_medium">
                    {label.LABEL_ASK_YouHaveThisProduct}
                  </p>
                </lightning-layout-item>
                <lightning-layout-item
                  size="12"
                  class="slds-var-p-vertical_small slds-align_absolute-center"
                >
                  <p class="slds-text-color_weak">
                    {label.LABEL_INFO_ReviewAndTellOthers}
                  </p>
                </lightning-layout-item>
                <lightning-layout-item
                  size="12"
                  class="slds-align_absolute-center"
                >
                  <button class="review-button" onclick={openAddReviewModal}>
                    {label.BUTTON_AddReview}
                  </button>
                </lightning-layout-item>
              </lightning-layout>
            </lightning-layout-item>
          </lightning-layout>
        </lightning-layout-item>

        <!-- Comments section -->
        <lightning-layout-item size="12" class="slds-var-m-top_small">
          <lightning-layout multiple-rows>
            <lightning-layout-item size="12" class="slds-border_bottom">
              <p class="slds-text-heading_medium slds-var-p-bottom_small">
                {label.LABEL_UsersOpinions}&nbsp;
                <span class="slds-text-color_weak slds-text-body_regular">
                  ({totalReviews})
                </span>
              </p>
            </lightning-layout-item>
            <lightning-layout-item size="12">
              <template for:each={reviews} for:item="review">
                <div key={review.reviewId} class="slds-border_bottom">
                  <c-review-tile review={review}></c-review-tile>
                </div>
              </template>
            </lightning-layout-item>
          </lightning-layout>
        </lightning-layout-item>
      </lightning-layout>
    </lightning-layout-item>
  </lightning-layout>
</template>
